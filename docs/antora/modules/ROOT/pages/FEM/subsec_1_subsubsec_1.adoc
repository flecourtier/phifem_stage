:stem: latexmath
:xrefstyle: short
= Presentation of the $\phi$-FEM method
= Presentation of the stem:[\phi]-FEM method

We will only consider here the case of the Poisson problem with Dirichlet condition. For more details on mesh assumptions, convergence results and finite element matrix condition number, please refer to #ref 12,8,10,19#. Models stem:[\phi]-FEM for the Poisson problem with Neumann or mixed conditions (Dirichlet and Neumann) are presented in \modif{ref ...}. For consideration of the elasticity problem, please refer to \modif{ref ...}.

== Description of spaces

We will consider the Poisson-Dirichlet problem
[stem]
++++
\left\{
\begin{aligned}
-\Delta u &= f, \; &&\text{in } \; \Omega, \\
u&=g, \; &&\text{on } \; \partial\Omega,
\end{aligned}
\right.
++++

where the domain stem:[\Omega] and its boundary stem:[\Gamma] are given by a level-set function stem:[\phi] such that
[stem]
++++
\Omega=\{\phi < 0\} \quad \text{and} \quad \Gamma=\{\phi = 0\}.
++++

The level-set function stem:[\phi] is supposed to be known on stem:[\mathbb{R}^d], smooth, and to behave near stem:[\Gamma] as the signed distance to stem:[\Gamma] (<<space1>>). 

[[space1]]
.Definition of the level-set function
image::FEM/PhiFEM_level_set.png[width=240.0,height=192.0]


---
*Example.*
If stem:[\Omega] is a circle of center stem:[A] and radius stem:[r], the level-set function can be defined by
[stem]
++++
\phi(x,y)=-r^2+(x-x_A)^2+(y-y_A)^2.
++++
If stem:[\Omega] is an ellipse with center stem:[A] and parameter stem:[(a,b)], the level-set function can be defined by
[stem]
++++
\phi(x,y)=-1+\frac{(x-x_A)^2}{a^2}+\frac{(y-y_A)^2}{b^2}.
++++

---

We assume that stem:[\Omega] is inside a domain stem:[\mathcal{O}] and we introduce a simple quasi-uniform mesh stem:[\mathcal{T}_h^\mathcal{O}] on stem:[\mathcal{O}] (<<space2>>).
 
We will consider stem:[\mathcal{T}_h] a sub-mesh of stem:[\mathcal{T}_h^\mathcal{O}] obtained by removing the elements located entirely outside stem:[\Omega] (<<space3>>). To be more specific, stem:[\mathcal{T}_h] is defines by
[stem]
++++
\mathcal{T}_h=\left\{T\in \mathcal{T}_h^\mathcal{O}:T\cap\{\phi_h<0\}\ne\emptyset\right\}.
++++
We note stem:[\Omega_h] the domain covered by the stem:[\mathcal{T}_h] mesh (stem:[\Omega_h] will be slightly larger than stem:[\Omega]) and stem:[\partial\Omega_h] its boundary (<<space3>>). The domain stem:[\Omega_h] is defined by
[stem]
++++
\Omega_h=\left(\cup_{T\in\mathcal{T}_h}T\right)^O
++++

[cols="a,a"]
|===
|[[space2]]
.Fictitious domain
image::FEM/PhiFEM_domain.png[width=300.0,height=240.0]
|[[space3]]
.Domain considered
image::FEM/PhiFEM_domain_considered.png[width=300.0,height=240.0]

|===

Now, we can introduce an approximation stem:[\phi_h\in V_{h,\mathcal{O}}^{(l)}] of stem:[\phi] given by stem:[\phi_h=I_{h,\mathcal{O}}^{(l)}(\phi)] where stem:[I_{h,\mathcal{O}}^{(l)}] is the standard Lagrange interpolation operator on
[stem]
++++
V_{h,\mathcal{O}}^{(l)}=\left\{v_h\in H^1(\mathcal{O}):v_{h|_T}\in\mathbb{P}_l(T) \;  \forall T\in\mathcal{T}_h^\mathcal{O}\right\}.
++++
By considering stem:[\Gamma_h=\{\phi_h=0\}], the approximate boundary of stem:[\Gamma], we can introduce stem:[\mathcal{T}_h^\Gamma\subset \mathcal{T}_h] (<<space4>>) which contains the mesh elements cut by the
approximate boundary stem:[\Gamma_h = \{\phi_h=0\}], i.e. 
[stem]
++++
\mathcal{T}_h^\Gamma=\left\{T\in \mathcal{T}_h:T\cap\Gamma_h\ne\emptyset\right\}.
++++
and stem:[\mathcal{F}_h^\Gamma] (<<space5>>) collects the interior facets of the mesh stem:[\mathcal{T}_h] either cut by stem:[\Gamma_h] or belonging to a cut mesh element
[stem]
++++
\mathcal{F}_h^\Gamma=\left\{E\;(\text{an internal facet of } \mathcal{T}_h) \text{ such that } \exists T\in \mathcal{T}_h:T\cap\Gamma_h\ne\emptyset \text{ and } E\in\partial T\right\}.
++++

[cols="a,a"]
|===
|[[space4]]
.Boundary cells
image::FEM/PhiFEM_boundary_cells.png[width=285.0,height=228.0]
|[[space5]]
.Boundary edges
image::FEM/PhiFEM_boundary_edges.png[width=300.0,height=240.0]

|===

== Description of the stem:[\phi]-FEM method

#Attention là cas homogène !#

As with standard FEM, the general idea behind stem:[\phi]-FEM is to find a weak solution (i.e. a solution to the variational problem) to the Poisson problem in question. The main difference lies in the spaces considered. In fact, we're no longer looking to solve the problem on stem:[\Omega] (of boundary stem:[\Gamma]) but on stem:[\Omega_h] (of boundary stem:[\partial\Omega_h]). Since our edge conditions are defined on stem:[\Gamma], we don't have a direct condition on the stem:[\partial\Omega_h] boundary, so we'll have to add terms to the variational formulation of the problem, called stabilization terms.

Assuming that the right-hand side stem:[f] is currently well-defined on stem:[\Omega_h] and that the solution stem:[u] can be extended on stem:[\Omega_h] such that stem:[-\Delta u=f] on stem:[\Omega_h], we can introduce a new unknown stem:[w\in H^1(\Omega_h)] such that stem:[u=\phi w] and the boundary condition on stem:[\Gamma] is satisfied. After integration by parts, we have
[stem]
++++
\int_{\Omega_h}\nabla(\phi w)\cdot\nabla(\phi v)-\int_{\partial\Omega_h}\frac{\partial}{\partial n}(\phi w)\phi v=\int_{\Omega_h} f\phi v,\quad \forall v\in H^1(\Omega_h)
++++
Given an approximation stem:[\phi_h] of stem:[\phi] on the mesh stem:[\mathcal{T}_h], as defined in Section #ADD paragraph label antora#, and a finite element space stem:[V_h] on stem:[\mathcal{T}_h], we can then search for stem:[w_h\in V_h] such that
[stem]
++++
a_h(w_h,v_h)=l_h(v_h), \quad \forall v_h\in V_h.
++++
We can consider the finite element space stem:[V_h=V_h^{(k)}] with
[stem]
++++
V_h^{(k)}=\left\{v_h\in H^1(\Omega_h):v_{h|_T}\in\mathbb{P}_k(T) \;  \forall T\in\mathcal{T}_h\right\}.
++++
The bilinear form stem:[a_h] and the linear form stem:[l_h] are defined by
[stem]
++++
a_h(w,v)=\int_{\Omega_h} \nabla (\Phi_h w) \cdot \nabla (\Phi_h v) - \int_{\partial\Omega_h} \frac{\partial}{\partial n}(\Phi_h w)\Phi_h v+G_h(w,v)
++++
and
[stem]
++++
l_h(v)=\int_{\Omega_h} f \Phi_h v + G_h^{rhs}(v)
++++
with
[stem]
++++
G_h(w,v)=\sigma h\sum_{E\in\mathcal{F}_h^\Gamma} \int_E \left[\frac{\partial}{\partial n}(\Phi_h w)\right] \left[\frac{\partial}{\partial n}(\Phi_h v)\right]+\sigma h^2\sum_{T\in\mathcal{T}_h^\Gamma} \int_{T} \Delta(\Phi_h w)\Delta(\Phi_h v)
++++
and
[stem]
++++
G_h^{rhs}(v)=-\sigma h^2\sum_{T\in\mathcal{T}_h^\Gamma} \int_{T} f \Delta(\Phi_h v)
++++
with stem:[\sigma] an independent parameter of h, which we'll call the stabilization parameter.

#Ajouter remarque en disant que stem:[\Omega_h] dépend implicitement de stem:[\phi] ?#

#Ajouter remarque terme au bord ne s'annule pas sur stem:[\partial\Omega_h] + expliquer ce que c'est crochets - termes de saut.#

#AJOUTER Explications termes de stabilisation !#

#Ajouter explication cas non homogène (dual et direct).#
:stem: latexmath
:xrefstyle: short
= Standard FEM
= Some details on FEM

After having seen the general principle of FEM, it remains to define the stem:[V_h] spaces and the stem:[\{\varphi_i\}] basis functions.


[NOTE]
====
The choice of stem:[V_h] space is fundamental to have an efficient method that gives a good approximation stem:[u_h] of stem:[u]. In particular, the choice of the stem:[\{\varphi_i\}] basis of stem:[V_h] influences the structure of the stem:[A] matrix in terms of its sparsity and its condition number.
====

#Rajouter intro différentes notions abordées !#

\trad{Pour ce faire, nous aurons besoin de plusieurs notions, qui seront détaillées dans les sections suivantes. Tout d'abord, nous aurons besoin de générer un maillage de notre domaine stem:[\Omega]. Ainsi, nous pourrons résoudre l'EDP de manière discrète, en des points choisis. C'est alors qu'intervient la notion d'éléments finis de Lagrange, les propriétés de ces éléments, notament en terme de famille affine d'élément fini est un point clé de la méthode qui va nous permettre de ramener chaque élément du maillage à un élément de référence à l'aide d'une transformation géométrique.}

== Unisolvance


[]
====
*Defintion.*
Let stem:[\Sigma=\{a_1,\dots,a_N\}] be a set of stem:[N] distinct points of stem:[\mathbb{R}^n]. Let stem:[P] be a finite-dimensional vector space of stem:[\mathbb{R}^n] functions taking values in stem:[\mathbb{R}]. We say that stem:[\Sigma] is stem:[P]-#unisolvent# if and only if for all real stem:[\alpha_1,\dots,\alpha_N], there exists a unique element stem:[p] of stem:[P] such that stem:[p(a_i)=\alpha_i,i=1,\dots,N]. 
This means that the function
[stem]
++++
\begin{aligned}
L \; : \; P &\rightarrow \mathbb{R}^N \\
p &\mapsto(p(a_1),\dots,p(a_N))
\end{aligned}
++++
is bijective.
====


[NOTE]
====
In practice, to show that stem:[\Sigma] is stem:[P]-#unisolvent#, we simply check that stem:[\dim P= \text{card } (\Sigma)] and then prove the injectivity or surjectivity of stem:[L]. The injectivity of stem:[L] is demonstrated by showing that the only function of stem:[P] that annuls on all points of stem:[\Sigma] is the null function. The surjectivity of stem:[L] is shown by identifying a family stem:[p_1,\dots,p_N] of elements of stem:[P] such that stem:[p_i(a_j)=\delta_{ij}]. Given real stem:[\alpha_1,\dots,\alpha_N], the function stem:[p=\sum_{i=1}^N\alpha_i p_i] then verifies stem:[p(a_j)=\alpha_j,j=1\dots,N]. 
====


[NOTE]
====
We call local basis functions of element stem:[K] the stem:[N] functions stem:[p_1,\dots,p_N] of stem:[P] such that
[stem]
++++
p_i(a_j)=\delta_{ij},\quad 1\le i,j\le N
++++
====

== Polynomial space

Let stem:[\mathbb{P}_k] be the vector space of polynomials of total degree less than or equal to stem:[k].


*  In stem:[\mathbb{R}] : stem:[\mathbb{P}_k=\text{Vect}\{1,X,\dots,X^k\}] and stem:[\dim\mathbb{P}_k=k+1] 
*  In stem:[\mathbb{R}^2] : stem:[\mathbb{P}_k=\text{Vect}\{X^iY^j,0\le i+j\le k\}] and stem:[\dim\mathbb{P}_k=\frac{(k+1)(k+2)}{2}]
*  In stem:[\mathbb{R}^3] : stem:[\mathbb{P}_k=\text{Vect}\{1,X^iY^jZ^l,0\le i+j+l\le k\}] and stem:[\dim\mathbb{P}_k=\frac{(k+1)(k+2)(k+3)}{6}]


Let stem:[\mathbb{Q}_k] be the vector space of polynomials of degree less than or equal to stem:[k] with respect to each variable.


*  In stem:[\mathbb{R}] : stem:[\mathbb{Q}_k=\mathbb{P}_k]. 
*  In stem:[\mathbb{R}^2] : stem:[\mathbb{Q}_k=\text{Vect}\{X^iY^j,0\le i,j\le k\}] and stem:[\dim\mathbb{Q}_k=(k+1)^2]
*  In stem:[\mathbb{R}^3] : stem:[\mathbb{Q}_k=\text{Vect}\{1,X^iY^jZ^l,0\le i,j,l\le k\}] and stem:[\dim\mathbb{Q}_k=(k+1)^3]


== Finite Lagrange Element

The most classic and simplest type of finite element is the Lagrange finite element.


[]
====
*Defintion (Lagrange Finite Element).*
A finite Lagrange element is a triplet stem:[(K,\Sigma,P)] such that 

*  stem:[K] is a geometric element of stem:[\mathbb{R}^n] (stem:[n=1,2] or stem:[3]), compact, connected and of non-empty interior.
*  stem:[\Sigma=\{a_1,\dots,a_N\}] is a finite set of stem:[N] distinct points of stem:[K].
*  stem:[P] is a finite-dimensional vector space of real functions defined on stem:[K] and such that stem:[\Sigma] is stem:[P]-#unisolvent# (so stem:[\dim P=N]).

====


---
*Example.*
Let stem:[K] be the segment stem:[[a_1,a_2]]. Let's show that stem:[\Sigma=\{a_1,a_2\}] is stem:[P]-#unisolvent# for stem:[P=\mathbb{P}^1]. Since stem:[\{1,x\}] is a base of stem:[\mathbb{P}^1], we have stem:[\dim P = \text{card } \Sigma = 2]. 

Moreover, we can write stem:[p_i=\alpha_i x+\beta_i, i=1,2]. Thus
[stem]
++++
\left\{\begin{aligned}
&p_1(a_1)=1 \\
&p_1(a_2)=0
\end{aligned}\right. \quad \iff	\quad
\left\{\begin{aligned}
&\alpha_1 a_1+\beta_1=1 \\
&\alpha_1 a_2+\beta_1=0
\end{aligned}\right. \quad \iff \quad
\left\{\begin{aligned}
&\alpha_1 = \frac{1}{a_1-a_2} \\
&\beta_1 = -\frac{a_2}{a_1-a_2}
\end{aligned}\right.
++++
and
[stem]
++++
\left\{\begin{aligned}
&p_2(a_1)=0 \\
&p_2(a_2)=1
\end{aligned}\right. \quad \iff	\quad
\left\{\begin{aligned}
&\alpha_2 a_1+\beta_2=0 \\
&\alpha_2 a_2+\beta_2=1
\end{aligned}\right. \quad \iff \quad
\left\{\begin{aligned}
&\alpha_1 = \frac{1}{a_2-a_1} \\
&\beta_1 = -\frac{a_1}{a_2-a_1}
\end{aligned}\right.
++++
Thus
[stem]
++++
p_1(x)=\frac{x-a_2}{a_1-a_2} \quad \text{and} \quad p_2(x)=\frac{x-a_1}{a_2-a_1}
++++
We deduce the surjectivity of stem:[L] and stem:[\Sigma] is stem:[\mathbb{P}^1]-#unisolvent#. 

Thus stem:[(K,\Sigma,P)] is a Lagrange Finite Element.

---


[]
====
*Defintion.*
Two finite elements stem:[(\hat{K},\hat{\Sigma},\hat{P})] and stem:[(K,\Sigma,P)] are affine-equivalent if and only if there exists an inversible affine function stem:[F] such that

*  stem:[K=F(\hat{K})]
*  stem:[a_i=F(\hat{a_i}),i=1,\dots,N] 
*  stem:[P=\{\hat{p}\circ F^{-1},\hat{p}\in\hat{P}\}].

We then call an *affine family of finite elements* a family of finite elements, all affine-equivalent to the same element stem:[(\hat{K},\hat{\Sigma},\hat{P})], called the \textbf{reference element}.
====

\modif{Rajouter stem:[p_i=\hat{p_i}\circ F^{-1}]}


[NOTE]
====
In practice, working with an affine family of finite elements means that all integral calculations can be reduced to calculations on the reference element. 

The reference elements in 1D, 2D triangular and 3D tetrahedral are :
.Example of reference Elements
image::FEM/reference_element.png[width=480.0,height=384.0]
====

== Mesh and geometric transformation

In 1D, the construction of a mesh consists in creating a subdivision of the interval stem:[[a,b]]. We can extend this definition in 2D and 3D by considering that a mesh is formed by a family of elements:
[stem]
++++
\mathcal{T}_h = \left\{K_1,\dots,K_{N_e}\right\}
++++
where stem:[N_e] is the number of elements. 

In 2D, these elements can be triangles or rectangles. In 3D, they can be tetrahedrons, parallelepipeds or prisms.

#TO COMPLETE ! (Mesh image + Geometric Transformation)#


[NOTE]
====
====


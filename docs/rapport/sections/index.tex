\section{Introduction}

This end of study internship is a 2nd year internship in the CSMI Master ("Calcul Scientifique et Mathématiques de l'Information") of the University of Strasbourg. It is the continuation of a project done during the first semester of M2, the main objective of this project was the discovery of an innovative non-conformal finite element method for augmented surgery, the $\phi$-FEM method. The purpose of this project was to have Cemosis and Mimesis collaborate through the use of Feel++ software (developed by Cemosis) in the framework of the $\phi$-FEM method (one of the research topics of the Mimesis team). This project was followed by a 6-month internship whose main objective was to correct the output of a Fourier Neural Operator (FNO) by a solver using the $\phi$-FEM method.

\subsection{Scientific Context}

Finite element methods (FEM) are used to solve partial differential equations numerically. These can, for example, represent analytically the dynamic behavior of certain physical systems (mechanical, thermodynamic, acoustic, etc.). Among other things, it is a discrete algorithm for determining the approximate solution of a partial differential equation (PDE) on a compact domain with boundary conditions. 

The standard FEM method, which requires precise meshing of the domain under consideration and, in particular, fitting with its boundary, has its limitations. In particular, in the medical field, meshing complex and evolving geometries such as organs (e.g. the liver) can be very costly. More specifically, in the application context of creating real-time digital twins of an organ, the standard FEM method would require complete remeshing of the organ each time it is deformed, which in practice is not workable. 

This is why other methods, known as non-conformal finite element methods, have emerged in the last few years. These include CutFEM \cite{burman_cutfem_2015} or XFEM \cite{moes_x-fem_2002}, based on the idea of introducing a fictitious domain larger than the domain under consideration. We're interested here in another non-conformal method, which we'll present in more detail later, called $\phi$-FEM. We'll only use it in the context of Poisson problem solving, for Dirichlet boundary conditions \cite{duprez_phi-fem_2020}. But the method has been extended to Neumann conditions \cite{duprez_new_2023} and then to solve various mechanical problems, including linear elasticity \cite[Chapter~2]{cotin_phi-fem_nodate} and heat transfer problems \cite[Chapter~5]{cotin_phi-fem_nodate}.

\subsection{Presentation of the team}

Created in January 2021 within ICube laboratory at the University of Strasbourg, MLMS\footnote{MLMS : \url{https://mlms.icube.unistra.fr/en/index.php/Presentation}} ("Machine Learning, Modélisation et Simulation") team is interested in data, models and simulations for medical science and human motion. It brings together computer scientists, mathematicians, bio-mechanicians, and neuroscientists to develop functional, physical, and geometric models around a transverse axis "Assistance to medical interventions by computer". MLMS hosts the MIMESIS\footnote{MIMESIS : \url{https://mimesis.inria.fr/}} project-team as a sub-team. The MIMESIS research team aims at creating real-time digital twins of an organ, with main application domains as surgical training and surgical guidance during complex interventions. In 2023, a new inria team NECTARINE will be created within MLMS, who will focus on scientific challenges related to neuro-stimulation in the clinical context. 

MIMESIS, directed by Stéphane Cotin, is a joint Inria\footnote{Inria : \url{https://www.inria.fr/fr}} ("Institut national de recherche en sciences et technologies du numérique") and CNRS\footnote{CNRS : \url{https://www.cnrs.fr/fr}} ("Centre national de la recherche scientifique") Research Team. The Mimesis research team is working on a set of scientific challenges in scientific computing, data assimilation, machine learning and control, with the goal of creating real-time digital twins of an organ.

\subsection{Objectives}

The main objective of the internship was to combine finite element methods and Machine Learning in order to solve the Poisson problem with Dirichlet condition. More precisely, we want to train a neural network called Fourier Neural Network (FNO) \cite{li_fourier_2021} to predict the solutions of a PDE for a given problem family (i.e. a "type" of source term). This neural network is trained with a data set consisting of the $\phi$-FEM solutions of the problems considered. The predictions of this neural network will then be fed back into a finite element solver to apply a correction to improve the accuracy of the solution : this was the subject covered during the internship. The finite element methods considered will be presented in Section \ref{FEMs} and the FNO in Section \ref{FNO}.

It is important to note that the $\phi$-FEM method has an advantage that is very interesting in the context of organ geometries. Indeed, this type of geometry can deform in time and meshing a fictitious domain around this geometry avoids having to remesh the geometry in time. Thus only the levelset function will be modified and the mesh can be fixed. Moreover, a Cartesian mesh of the fictitious domain allows us to use the same type of neural network as those applied to images (especially FNO).

To be more precise, we will test different correction methods (presented in Section \ref{Corr.methods}) on different problems (presented in Section \ref{Corr.problems}) which will enable us to use the network prediction to help the solver get as close as possible to the solution. We will start by testing these different types of solver on an analytical solution (Section \ref{Corr.results.ana}), then on a "manually perturbed" solution (Section \ref{Corr.results.disturbed}) and finally on a $\phi$-FEM solution (Section \ref{Corr.results.phifem}).

After testing the various types of correction on the previous test cases, we'll apply these same methods to the prediction of an FNO (Section \ref{Corr.results.FNO}). The main objective is to enable the combination of FNO and correction to be more accurate than the conventional $\phi$-FEM solver. By first testing the different corrections on the previous test cases, we hope to get an idea of the order of errors to be expected. During the course of the internship, we realized that the results obtained on the FNO did not correspond to the expected analytical results. For this reason, other types of neural networks were considered, namely multi-perceptron networks (Section \ref{Corr.results.neural_net.MLP}) and PINNs (Section \ref{Corr.results.neural_net.PINNs}), with the aim of checking whether the results obtained are related to the use of the FNO.

\subsection{Deliverables}

In the context of the internship, the following deliverables are provided:

\begin{enumerate}[label=\textbullet]
	\item a \href{https://github.com/flecourtier/phifem_stage/blob/main/docs/suivi/suivi.pdf}{weekly tracking report}, written in French, was produced as the internship progressed, listing the objectives and results for each week.
	\item a \href{https://github.com/flecourtier/phifem_stage}{github repository} containing all the code allowing to reproduce the results presented in this report, as well as the documents written during the internship. The codes have been implemented in Python: for the finite element solvers, we'll be using the FEniCS library, and for the neural network implementation, we'll be using Tensorflow and Pytorch.
	\item an \href{https://flecourtier.github.io/phifem_stage/phifem_project/1.0.3/main_page.html}{online report} generated with a tool called antora\footnote{Antora : \url{https://antora.org/}}. A continuous integration has been set up on github to execute a python code for each new push, enabling the latex file to be converted directly into this antora documentation.
%	\item a code documentation has also been set up with sphinx\footnote{Sphinx : \url{https://www.sphinx-doc.org/en/master/}}.
\end{enumerate}
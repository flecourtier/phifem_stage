<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Correction with FNO :: PhiFEM Project - Docs</title>
    <link rel="canonical" href="https://flecourtier.github.io/phifem_stage/phifem_project/1.0.3/corr/subsec_3_subsubsec_3.html">
    <meta name="generator" content="Antora 3.1.2">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <link rel="icon" href="../../../_/img/favicon.ico" type="image/x-icon">
    <script>!function(l,p){if(l.protocol!==p&&l.host=="docs.antora.org"){l.protocol=p}else if(/\.gitlab\.io$/.test(l.host)){l.replace(p+"//docs.antora.org"+l.pathname.substr(l.pathname.indexOf("/",1))+l.search+l.hash)}}(location,"https:")</script>

    <link rel="stylesheet" type="text/css" href="/_/css/style.css">




<script>var uiRootPath = '../../../_'</script>

  </head>
  <body class="article">
<header class="header" role="banner">
  <nav class="navbar">
    <div class="navbar-brand">
      <div class="navbar-item">
        <a href="https://flecourtier.github.io/phifem_stage">PhiFEM Project - Docs</a>
      </div>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <div class="navbar-item has-dropdown is-hoverable">
          <div class="navbar-link">Project</div>
          <div class="navbar-dropdown">
            <div class="navbar-item"><strong>GitHub</strong></div>
            <a class="navbar-item" href="https://github.com/master-csmi/2022-m2-phifem">GitHub Repository</a>
            <a class="navbar-item" href="https://github.com/orgs/master-csmi/projects/9/views/8">GitHub Issue Tracker</a>
            <a class="navbar-item" href="https://master-csmi.github.io/2022-m2-phifem/phifem_project/1.0.3/">Project Report</a>
            <hr class="navbar-divider">
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <div class="navbar-link">Internship</div>
          <div class="navbar-dropdown">
            <div class="navbar-item"><strong>GitHub</strong></div>
            <a class="navbar-item" href="https://github.com/flecourtier/phifem_stage">GitHub Repository</a>
            <a class="navbar-item" href="https://github.com/flecourtier/phifem_stage/blob/main/docs/suivi/suivi.pdf">Weekly tracking (PDF)</a>
            <a class="navbar-item" href="https://github.com/flecourtier/phifem_stage/blob/main/docs/rapport/rapport.pdf">Internship report (PDF)</a>
            <hr class="navbar-divider">
          </div>
        </div>
        <div class="navbar-item">
          <a class="navbar-brand" href="https://mimesis.inria.fr/">
            <img src="../../../_/img/mimesis2.png" alt="mimesis" style="width:90px;"></a>
        </div>
        <div class="navbar-item">
          <a class="navbar-brand" href="https://www.inria.fr/fr">
            <img src="../../../_/img/inria.png" alt="inria" style="width:90px;"></a>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="phifem_project" data-version="1.0.3">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">Phi-FEM Project</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../main_page.html">PhiFEM project</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../index.html">Introduction</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../index/subsec_0.html">Scientific Context</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../index/subsec_1.html">Presentation of the team</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../index/subsec_2.html">Objectives</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../index/subsec_3.html">Deliverables</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../FEM.html">Finite Element Methods (FEMs)</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../FEM/subsec_0.html">Standard FEM</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../FEM/subsec_0_subsubsec_0.html">Some notions of functional analysis.</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../FEM/subsec_0_subsubsec_1.html">General principle of the method</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../FEM/subsec_0_subsubsec_2.html">Some details on FEM</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../FEM/subsec_0_subsubsec_3.html">Application to the Poisson problem</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../FEM/subsec_1.html">\(\phi\)-FEM</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../FEM/subsec_1_subsubsec_0.html">Context and general principle of the method</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../FEM/subsec_1_subsubsec_1.html">General presentation of the \(\phi\)-FEM method</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../FEM/subsec_1_subsubsec_2.html">Some details on \(\phi\)-FEM</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../fourier.html">Fourier Neural Operator (FNO)</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../fourier/subsec_0.html">Architecture of the FNO</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../fourier/subsec_1.html">Fourier Layer structure</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../fourier/subsec_2.html">Some details on the convolution sublayer</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../fourier/subsec_3.html">Application</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../corr.html">Correction</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="subsec_0.html">Presentation of different problems considered</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="subsec_0_subsubsec_0.html">First domain : the Circle.</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="subsec_0_subsubsec_1.html">Second domain : the Square.</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="subsec_1.html">Presentation of the different correction methods considered</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="subsec_1_subsubsec_0.html">Correction by adding</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="subsec_1_subsubsec_1.html">Correction by multiplying</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="subsec_1_subsubsec_2.html">Correction by multiplying on an elevated problem</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="subsec_2.html">Theorical results</a>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="subsec_3.html">Numerical results</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="subsec_3_subsubsec_0.html">Correction on exact solution</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="subsec_3_subsubsec_1.html">Correction on disturbed solution</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="subsec_3_subsubsec_2.html">Correction on \(\phi\)-FEM solution</a>
  </li>
  <li class="nav-item is-current-page" data-depth="4">
    <a class="nav-link" href="subsec_3_subsubsec_3.html">Correction with FNO</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="subsec_3_subsubsec_4.html">Correction with other networks</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../conclu.html">Conclusion</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../section_5.html">Bibliography</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Phi-FEM Project</span>
    <span class="version">1.0.3</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="../index.html">Phi-FEM Project</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">1.0.3</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../main_page.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">Phi-FEM Project</a></li>
    <li><a href="../main_page.html">PhiFEM project</a></li>
    <li><a href="../corr.html">Correction</a></li>
    <li><a href="subsec_3.html">Numerical results</a></li>
    <li><a href="subsec_3_subsubsec_3.html">Correction with FNO</a></li>
  </ul>
</nav>

  
<div class="dropdown">
  <button class="dropbtn" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <div class="dropdown-content">


          <a onclick="print(this)"  class="headerbtn"  data-toggle="tooltip" data-placement="left" title="Print to PDF">
              .pdf <i class="fas fa-file-pdf"></i>
          </a>

  </div>
</div>
  
<div class="dropdown">
  <button class="dropbtn" aria-label="Github">
    <i class="fab fa-github"></i>
  </button>
  <div class="dropdown-content">

    <a href="https://github.com/flecourtier/phifem_stage">Open repository <i class="fab fa-github"></i></a>
    
  <a href="https://github.com/flecourtier/phifem_stage/edit/main/docs/antora/modules/ROOT/pages/corr/subsec_3_subsubsec_3.adoc">Edit this Page <i class="fas fa-edit"></i></a>

    <a href="https://github.com/feelpp/book.feelpp.org/issues/new">Open issue <i class="fas fa-lightbulb"></i></a>


  </div>
</div>


<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>
</div>

  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>

<article class="doc">
<h1 class="page">Correction with FNO</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p><mark>A TRADUIRE !!!</mark></p>
</div>
<div class="paragraph">
<p>In this section, we&#8217;ll consider the problem presented in <a href="#_\(f\)_gaussian">[_\(f\)_gaussian]</a>, where we take as geometry the circle and \(f\) Gaussian. In practice, this is a very probable case, i.e. one in which no exact solution is known. As explained above, we&#8217;ll take an over-refined solution (calculated with FEM) as our reference solution.</p>
</div>
<div class="paragraph">
<p>We want to train an FNO to predict the solutions of the problem under consideration and test the correction on its predictions. To do this, we&#8217;ll follow the steps presented in <a href="../fourier/subsec_3.html" class="xref page">Section "Application"</a>. In the following, we&#8217;ll choose an FNO with 4 Fourier layers.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_training_the_fno"><a class="anchor" href="#_training_the_fno"></a>1. Training the FNO</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We start by training the FNO with \(\phi\)-FEM solutions. To do this, we consider a number of training data \(n_{data}\) and perform the following steps:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>First, we randomly generate a sample of parameters defined by</p>
</li>
</ul>
</div>
\{\mu_0^{(i)},\mu_1^{(i)},\sigma^{(i)}\}_{i=1,\dots,n_{data}}
<div class="paragraph">
<p>with \(\sigma \sim \mathcal{U}([0.1,0.6\))] and \(\mu_0, \mu_1 \sim \mathcal{U}([0.5-\sqrt{2}/4, 0.5+\sqrt{2}/4\))] with the condition \(\phi(\mu_0, \mu_1) &lt; -0.05\).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The condition \(\phi(\mu_0, \mu_1) &lt; -0.05\) ensures that the center \((\mu_0, \mu_1)\) of the Gaussian is inside the domain.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>From the parameter sample created, we can generate a Gaussian sample defined by</p>
</div>
<div class="stemblock">
<div class="content">
\[\{f_i\}_{i=1,\dots,n_{data}}=\left\{\exp\left(-\frac{(x-\mu_0^{(i)})^2 + (y-\mu_1^{(i)})^2}{2(\sigma^{(i)})^2}\right)\right\}_{i=1,\dots,n_{data}}\]
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>As explained in <a href="../fourier/subsec_3.html" class="xref page">Section "Application"</a>, each Gaussian is in fact evaluated at the nodes of our grid, so they are 2D matrices of size \(n_{vert}\times n_{vert}\).</p>
</div>
<div class="paragraph">
<p>We can also consider the degrees of freedom \(\mathbb{P}_2\), which also form a regular grid, as they are composed of the nodes as well as the midpoints of each segment. So our matrices will be of size \(n_{dofs}\times n_{dofs}\) (with \(n_{dofs}=2n_{vert}-1\)). In the following, we&#8217;ll choose \(n_{vert}\)=32 and thus \(n_{dofs}=63\).</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In our case, the geometry is fixed (the circle with center \((0.5,0.5)\) and radius \(\sqrt{2}/4\)), so we will not have a level-set collection in our training data. Similarly, we choose to consider the homogeneous problem and so, since \(g=0\) on \(\Gamma\), we won&#8217;t have a collection of Dirichlet conditions in our training data either.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>We can now use the \(\phi\)-FEM scheme associated with the Poisson problem with homogeneous Dirichlet condition defined in <a href="#_description_of_the_\(\phi\)-fem_method">[_description_of_the_\(\phi\)-fem_method]</a> to solve for each \(i=1,\dots,n_{data}\), the problem</p>
</li>
</ul>
</div>
\left\{
\begin{aligned}
-\Delta (\phi w_i) &= f_i, \; &&\text{in } \; \Omega, \\
u_i&=0, \; &&\text{on } \; \partial\Omega,
\end{aligned}
\right.
<div class="paragraph">
<p>with \(u_i=\phi w_i\).</p>
</div>
<div class="paragraph">
<p>We thus have a collection of \(\phi\)-FEM solutions of the problem defined by</p>
</div>
<div class="stemblock">
<div class="content">
\[\{u_i\}_{i=1,\dots,n_{data}}=\{\phi w_i\}_{i=1,\dots,n_{data}}\]
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>From the previous collections, we can now create the X_train and Y_train samples that will enable us to train the FNO. We&#8217;ll start by performing a kind of pre-processing on our data (explained in <a href="../fourier/subsec_3.html" class="xref page">Section "Application"</a>) by normalizing the source term collection. We thus consider</p>
</li>
</ul>
</div>
f_{i,norm} = \frac{f_i}{max_{j=1},\dots,n_{data} ||f_j||_{L^2(\mathcal{O})}}, \quad \forall i\in 1,\dots,n_{data}.
<div class="paragraph">
<p>We can now define X_train as follows</p>
</div>
<div class="stemblock">
<div class="content">
\[X_train =  \left\{f_{i,norm},F_{i,norm}^{(x)},F_{i,norm}^{(y)},F_{i,norm}^{(xx)},F_{i,norm}^{(yy)}\right\}_{i=1,\dots,n_{data}}\]
</div>
</div>
<div class="paragraph">
<p>of size \((n_{data},n_{vert},n_{vert},5)\) where \(F_{i,norm}^{(x)},F_{i,norm}^{(y)},F_{i,norm}^{(xx)}\) and \(F_{i,norm}^{(yy)}\) are respectively the first primitives of \(f_{i,norm}\) according to x and y and the second primitives of \(f_{i,norm}\) according to x and y.
Y_train can also be constructed as follows</p>
</div>
<div class="stemblock">
<div class="content">
\[Y_train = \{w_i\}_{i=1,\dots,n_{data}}\]
</div>
</div>
<div class="paragraph">
<p>of size \((n_{data},n_{vert},n_{vert},1)\).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Considering the term \(w\) as training data rather than \(u\) ensures that the conditions at the edge will be accurate at the output of the FNO. Indeed, multiplying the FNO prediction by \(\phi\) guarantees \(u=0\) on \(\Gamma\).</p>
</div>
<div class="paragraph">
<p>Similarly, in the non-homogeneous case, we simply multiply the FNO prediction by \(\phi\) and then add the Dirichlet condition \(g\).</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>In practice, the set defined above is separated into 2 sets: the training set (X_train,Y_train), which trains the FNO, and the validation set (X_val,Y_val), which validates the training. Together, these two sets contain the \(n_{data}\) under consideration. In the following, we&#8217;ll consider \(n_{data}\) to be the size of our separate training set (for 1000 data at the beginning, after separation we have \(n_{data}=875\)).</p>
</div>
</td>
</tr>
</table>
</div>
<div class="ulist">
<ul>
<li>
<p>We can now train our FNO by minimizing the loss defined by</p>
</li>
</ul>
</div>
loss_\theta = loss_\theta^{(0)} + loss_\theta^{(1)} + loss_\theta^{(2)}
<div class="paragraph">
<p>with</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{aligned}
loss_\theta^{(0)} &amp;= \frac{1}{n_{data}}\sum_{i=1}^{n_{data}} mse(w_i-w_{\theta,i}) \\
loss_\theta^{(1)} &amp;= \frac{1}{n_{data}}\sum_{i=1}^{n_{data}} mse(\nabla_x(w_i)-\nabla_x(w_{\theta,i}))+mse(\nabla_y(w_i)-\nabla_y(w_{\theta,i})) \\
loss_\theta^{(2)} &amp;= \frac{1}{n_{data}}\sum_{i=1}^{n_{data}} mse(\nabla_{xx}(w_i)-\nabla_{xx}(w_{\theta,i})) + mse(\nabla_{yy}(w_i)-\nabla_{yy}(w_{\theta,i}))
\end{aligned}\]
</div>
</div>
<div class="paragraph">
<p>where \(loss_\theta^{(i)}\) will in practice be called misfit \(i\), \(i=0,1,2\).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>In practice, it may be more interesting to train the FNO directly on \(\phi w\). However, all the results presented here were obtained with loss on w and not \(\phi w\).</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>By training our FNO over 4000 epochs with a batch size of 64, we obtain the following misfits as a function of epochs (<a href="#misfits_f_gaussian">[misfits_f_gaussian]</a>):</p>
</div>
<div id="misfits_f_gaussienne" class="imageblock unresolved">
<div class="content">
<img src="corr/orr_FNO/misfits_f_gaussienne.pn" alt="misfits f gaussienne" width="360.0" height="288.0">
</div>
<div class="title">Figure 1. Misfits obtained during FNO training by epoch (line - training set, point - validation set).</div>
</div>
<div class="paragraph">
<p><strong>Results on the validation set :</strong></p>
</div>
<div class="paragraph">
<p>We&#8217;re interested here in the \(||\cdot||_{0,abs}\) errors obtained at the end of training on the validation set. In fact, we&#8217;re going to consider different checkpoints in the training, or to be more precise, we&#8217;re interested in different moments in the training (i.e. we&#8217;ll have 8 similar models whose total number of epochs differs: for the first, we make 500 epochs, for the second we make 1000&#8230;&#8203; up to the last at 4000 epochs). Here are the errors obtained on the validation sample for each of these 8 checkpoints (<a href="#error_val_f_gaussian">[error_val_f_gaussian]</a>):</p>
</div>
<div id="erreur_val_f_gaussienne" class="imageblock unresolved">
<div class="content">
<img src="corr/orr_FNO/erreur_val_f_gaussienne.pn" alt="erreur val f gaussienne" width="540.0" height="432.0">
</div>
<div class="title">Figure 2. Errors obtained on the validation set at different training checkpoints (every 500 epochs).</div>
</div>
<div class="paragraph">
<p>Here are the mean, standard deviation, minimum and maximum error values obtained on the validation set at these different checkpoints (<a href="#infos_val_f_gaussian">[infos_val_f_gaussian]</a>), as well as the boxplots of the errors at each checkpoint (<a href="#boxplot_val_f_gaussian">[boxplot_val_f_gaussian]</a>):</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div id="infos_val_f_gaussienne" class="imageblock unresolved">
<div class="content">
<img src="corr/orr_FNO/infos_val_f_gaussienne.pn" alt="infos val f gaussienne" width="270.0" height="216.0">
</div>
<div class="title">Figure 3. Mean, standard deviation, minimum and maximum errors on the validation set according to checkpoints.</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div id="boxplot_val_f_gaussienne" class="imageblock unresolved">
<div class="content">
<img src="corr/orr_FNO/boxplot_val_f_gaussienne.pn" alt="boxplot val f gaussienne" width="270.0" height="216.0">
</div>
<div class="title">Figure 4. Boxplots of the errors on the validation set according to checkpoints.</div>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Results on a test set :</strong></p>
</div>
<div class="paragraph">
<p>This time we&#8217;re interested in a new test sample of size \(n_{test}=100\), denoted X_test, created in exactly the same way as the training sample (with parameters again created randomly) and we&#8217;re looking to reproduce exactly the same results as on the validation set. Here are the errors obtained on the test sample for each of these 8 checkpoints (<a href="#error_test_f_gaussian">[error_test_f_gaussian]</a>):</p>
</div>
<div id="erreur_test_f_gaussienne" class="imageblock unresolved">
<div class="content">
<img src="corr/orr_FNO/erreur_test_f_gaussienne.pn" alt="erreur test f gaussienne" width="540.0" height="432.0">
</div>
<div class="title">Figure 5. Errors obtained on the test set at different training checkpoints (every 500 epochs).</div>
</div>
<div class="paragraph">
<p>Here are the mean, standard deviation, minimum and maximum error values obtained on the test set at these different checkpoints (<a href="#infos_test_f_gaussian">[infos_test_f_gaussian]</a>), as well as the boxplots of the errors at each checkpoint (<a href="#boxplot_test_f_gaussian">[boxplot_test_f_gaussian]</a>):</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div id="infos_test_f_gaussienne" class="imageblock unresolved">
<div class="content">
<img src="corr/orr_FNO/infos_test_f_gaussienne.pn" alt="infos test f gaussienne" width="270.0" height="216.0">
</div>
<div class="title">Figure 6. Mean, standard deviation, minimum and maximum errors on the test set according to checkpoints.</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div id="boxplot_test_f_gaussienne" class="imageblock unresolved">
<div class="content">
<img src="corr/orr_FNO/boxplot_test_f_gaussienne.pn" alt="boxplot test f gaussienne" width="270.0" height="216.0">
</div>
<div class="title">Figure 7. Boxplots of the errors on the test set according to checkpoints.</div>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Observation :</strong> <mark>A FAIRE !</mark></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_correction_of_the_fno_prediction"><a class="anchor" href="#_correction_of_the_fno_prediction"></a>2. Correction of the FNO prediction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>As with the analytical solution and the perturbed solution, the \(\phi\)-FEM method is used to test the various correction methods presented in <a href="subsec_1.html" class="xref page">Section "Presentation of the different correction methods considered"</a> on the test sample (of size \(n_{test}=100\)) created in <a href="#_training_the_fno">Section 1</a>, i.e. correction by addition, correction by multiplication and correction by multiplication on an elevated problem. For each piece of data in the test sample, we consider</p>
</div>
<div class="stemblock">
<div class="content">
\[\tilde{\phi}=u_{FNO}=\phi w_{FNO}\]
</div>
</div>
<div class="paragraph">
<p>with \(w_{FNO}\) the prediction made by the FNO on the current data.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Note that, unlike correction on analytic or perturbed solutions, the FNO can only predict the solution at points on the regular grid (i.e. nodes or degrees of freedom \(\mathbb{P}^2\)). At FNO output, we can therefore only provide our correctors with \(\tilde{\phi}\) in \(\mathbb{P}_2\).</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For correction by multiplication on a elevated problem, we use the dual method to impose conditions at the boundary.</p>
</div>
<div class="paragraph">
<p>Here are the errors obtained with the different correction methods, in addition to those obtained directly at the FNO output, according to the checkpoints (<a href="#corr_errors">Figure 8</a>).</p>
</div>
<div id="corr_errors" class="imageblock unresolved">
<div class="content">
<img src="corr/orr_FNO/corr_errors.pn" alt="corr errors" width="540.0" height="432.0">
</div>
<div class="title">Figure 8. Errors obtained with the FNO and with different correction methods according to checkpoints.</div>
</div>
<div class="paragraph">
<p>We can also plot the error boxplots at each checkpoint (<a href="#corr_boxplot">Figure 9</a>):</p>
</div>
<div id="corr_boxplot" class="imageblock unresolved">
<div class="content">
<img src="corr/orr_FNO/corr_boxplot.pn" alt="corr boxplot" width="360.0" height="288.0">
</div>
<div class="title">Figure 9. Errors obtained with the FNO and with different correction methods according to checkpoints.</div>
</div>
<div class="paragraph">
<p><strong>Observation :</strong> <mark>A faire !</mark></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_high_degree_interpolation"><a class="anchor" href="#_high_degree_interpolation"></a>3. High degree interpolation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>As explained in <a href="#_correction_of_the_fno_prediction">Section 2</a>, it would seem that considering \(\tilde{\phi}\) only in \(\mathbb{P}^2\), is not sufficient for the various correction methods applied after the FNO to be more accurate than the initial \(\phi\)-FEM method. For this reason, we&#8217;re going to attempt to interpolate the solution in order to evaluate this interpolation in a \(\mathbb{P}_k\) space of higher degree (\(k&gt;2\)). To do this, we&#8217;ll decompose our solution into a series of polynomials, choosing Legendre polynomials.</p>
</div>
<div class="paragraph">
<p><strong>Explanation :</strong></p>
</div>
<div class="paragraph">
<p>We want to decompose a function into a series of Legendre polynomials as follows:</p>
</div>
<div class="stemblock">
<div class="content">
\[f(x,y)=\sum_{p=0}^{P-1}\sum_{q=0}^{Q-1}\alpha_{p,q}P_p(x)P_q(y)
\label{decomp}\]
</div>
</div>
<div class="paragraph">
<p>where the Legendre polynomials are defined for all \(n\in\mathbb{N}\) and \(x\in\mathbb{R}\) by</p>
</div>
<div class="stemblock">
<div class="content">
\[P_n(x)=\frac{1}{2^n n!}\frac{d^n}{dx^n}[(x^2-1)^n]\]
</div>
</div>
<div class="paragraph">
<p>and \(P\) and \(Q\) are respectively the number of Legendre polynomials associated with \(x\) and \(y\).
Note that the Legendre polynomials are orthogonal in the space \(L^2(\)-1,1[)] and more precisely \(\forall n,m\in\mathbb{N}\),</p>
</div>
<div class="stemblock">
<div class="content">
\[\langle P_n,P_m\rangle_{L^2(]-1,1[)}=\int_{-1}^1 P_n(x)P_m(x)dx=\frac{2}{2n+1}\delta_{nm}.
\label{ortho}\]
</div>
</div>
<div class="paragraph">
<p>Let us first show that for \(p\in\{0,\dots,P-1\}\) and \(q\in\{0,\dots,Q-1\}\), the polynomials</p>
</div>
<div class="stemblock">
<div class="content">
\[Q_{p,q}(x,y)=P_p(x)P_q(y)\]
</div>
</div>
<div class="paragraph">
<p>are orthogonal in space \(L^2(\)-1,1[^2)] :</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Numerically, we&#8217;ll use the trapezoid method to calculate the scalar product on \(L^2(\)-1,1[^2)].</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Let \(p,p'\in\{0,\dots,P-1\}\) and \(q,q'\in\{0,\dots,Q-1\}\), then</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{aligned}
\langle Q_{p,q},Q_{p',q'}\rangle_{L^2(]-1,1[^2)}\int_{-1}^1 \int_{-1}^1 Q_{p,q}(x,y)Q_{p',q'}(x,y)dxdy&amp;=\int_{-1}^1 \int_{-1}^1 P_p(x)P_q(y)P_{p'}(x)P_{q'}(y)dxdy \\
&amp;=\int_{-1}^1 P_p(x)P_{p'}(x)dx\times \int_{-1}^1 P_q(y)P_{q'}(y)dy \\
&amp;=\frac{2}{2p+1}\delta_{pp'}\frac{2}{2q+1}\delta_{qq'} \\
&amp;=\frac{4}{(2p+1)(2q+1)}\delta_{(p,q)(p',q')}
\end{aligned}\]
</div>
</div>
<div class="paragraph">
<p>Thus</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{aligned}
\int_{-1}^1 \int_{-1}^1 f(x,y)Q_{p,q}(x,y)dxdy &amp;= \langle f,Q_{p,q}\rangle_{L^2(]-1,1[^2)} \\
&amp;=\sum_{p=0}^{P-1}\sum_{q=0}^{Q-1}\alpha_{p,q} \langle Q_{p,q},Q_{p',q'}\rangle_{L^2(]-1,1[^2)} \\
&amp;=\alpha_{p',q'} \langle Q_{p',q'},Q_{p',q'}\rangle_{L^2(]-1,1[^2)} \\
\end{aligned}\]
</div>
</div>
<div class="paragraph">
<p>by orthogonality of polynomials \(Q_{p,q}\) in  \(L^2(\)-1,1[^2)].</p>
</div>
<div class="paragraph">
<p>We deduce</p>
</div>
<div class="paragraph">
<p>\(]\alpha_{p',q'} = \frac{\langle f,Q_{p',q'}\rangle_{L^2(\)-1,1[^2)}}{\langle Q_{p',q'},Q_{p',q'}\rangle_{L<sup>2(]-1,1[</sup>2)}}=\frac{(2p'+1)(2q'+1)}{4}\langle f,Q_{p',q'}\rangle_{L<sup>2(]-1,1[</sup>2)}stem:[]</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>For \(x\in[a,b\)], we make a change of variable to bring us back to the interval \([-1,1\)] by considering</p>
</div>
<div class="stemblock">
<div class="content">
\[\tilde{x}=\frac{2}{b-a}x+\frac{a+b}{a-b}\]
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>So, assuming that the function \(f\) is evaluated on a regular grid, of domain \(\mathcal{O}\), of size \(N\times N\) (which corresponds to the type of output we get from FNO), then we can calculate the coefficients \(\alpha_{p,q}\) for \(p\in\{0,\dots,P-1\}\) and \(q\in\{0,\dots,Q-1\}\). This gives us an analytical expression for the function corresponding to a series of Legendre polynomials, enabling us to interpolate our function in all \(x,y\in\Omega\).</p>
</div>
<div class="paragraph">
<p><strong>Decomposition of an analytical function into a Legendre polynomial series :</strong></p>
</div>
<div class="paragraph">
<p>We want to test Legendre&#8217;s polynomial series decomposition on the following analytical function</p>
</div>
<div class="stemblock">
<div class="content">
\[f(x,y)=\exp\left(-\frac{(x-\mu_0)^2 + (y-\mu_1)^2}{2\sigma^2}\right)\]
</div>
</div>
<div class="paragraph">
<p>with \(x,y\in [0,1\)], \(\mu=0\) and \(\sigma=1\).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>In practice, with the FNO, it&#8217;s \(u\) that we want to interpolate (for which we don&#8217;t have an analytical expression) and not \(f\).</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Let&#8217;s take \(P=Q=5\) and consider the evaluation of \(f\) on a regular \(N\times N\) grid of \([0,1\)^2] with \(N=100\). After calculating the coefficients \(\alpha_{p,q}\) for \(p\in \{0,\dots,P-1\}\) and \(q\in \{0,\dots,Q-1\}\), we can evaluate the expression</p>
</div>
<div class="stemblock">
<div class="content">
\[f(x,y)=\sum_{p=0}^{P-1}\sum_{q=0}^{Q-1}\alpha_{p,q}P_p(x)P_q(y)\]
</div>
</div>
<div class="paragraph">
<p>at any point \(x,y\in[0,1\)]. Considering, for example, a new regular grid of size \(N_2\times N_2\) of \([0,1\)^2] with \(N_2=500\), we obtain an error \(||\cdot||_0\) between the analytical solution and the expression of the solution in a series of Legendre polynomials of \(8.1e-4\) (<a href="#legendre_ana">Figure 10</a>).</p>
</div>
<div id="legendre_ana" class="imageblock unresolved">
<div class="content">
<img src="corr/orr_FNO/legendre_ana.pn" alt="legendre ana" width="360.0" height="288.0">
</div>
<div class="title">Figure 10. Reconstruction of the solution by Legendre polynomials on a new grid of size \(500\times 500\).</div>
</div>
<div class="paragraph">
<p><strong>Decomposition of the FNO predictions into a Legendre polynomial series :</strong></p>
</div>
<div class="paragraph">
<p>We will again consider the problem presented in <a href="#_\(f\)_gaussian">[_\(f\)_gaussian]</a>, where we take as geometry the circle and \(f\) as being a Gaussian. We again consider the sample \(X_test\) (of size \(n_{test}=100\)) but this time with \(n_{vert}=300\) (and therefore \(n_{dofs}=599\)) to integrate more precisely and thus have a better approximation of the decomposition coefficients. We seek to decompose each FNO output \(w_{\theta,i}\), \(i=1,\dots,n_{test}\) into a series of Legendre polynomials, defined by</p>
</div>
<div class="stemblock">
<div class="content">
\[w_{\theta,i}(x,y)=\sum_{p=0}^{P-1}\sum_{q=0}^{Q-1}\alpha_{p,q}P_p(x)P_q(y)\]
</div>
</div>
<div class="paragraph">
<p>and thus</p>
</div>
<div class="stemblock">
<div class="content">
\[u_{\theta,i}=\phi(x,y)w_{\theta,i}(x,y).\]
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Note that each data in the test sample has its own decomposition.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In the following, we&#8217;ll consider \(P=Q\) and test the decomposition for \(P=4\), \(P=6\) and \(P=8\) on each data of the test sample and at each checkpoint considered. First, we&#8217;ll look at the mean error made by the decomposition into a series of Legendre polynomials, which we&#8217;ll call the mean reconstruction error (<a href="#mean_error_reconstruction">Figure 11</a>). In other words, for each data item, we calculate the coefficients of the decomposition from the known values of the solution in degrees of freedom \(\mathbb{P}_2\), denoted W_pred (of size \((n_{test},n_{dofs},n_{dofs})\)). We then look at the reconstruction of the solution by the decomposition into a series of Legendre polynomials in these same degrees of freedom \(\mathbb{P}_2\), denoted W_pred_reconstruct (of size \((n_{test},n_{dofs},n_{dofs})\)), then we calculate the error
\begin{center}
 mean_error_reconstruction = \(||\)W_pred-W_pred_reconstruct\(||_{0,\mathcal{O}}\)
\end{center}</p>
</div>
<div id="mean_error_reconstruction" class="imageblock unresolved">
<div class="content">
<img src="corr/orr_FNO/mean_error_reconstruction.pn" alt="mean error reconstruction" width="540.0" height="432.0">
</div>
<div class="title">Figure 11. Mean reconstruction error for each data in test set (at each checkpoint).</div>
</div>
<div class="paragraph">
<p>Looking at the results, it seems that the decomposition works. However, it would appear that, on average, we are not as precise as in the analytical case considered.</p>
</div>
<div class="paragraph">
<p>We can now look at the maximum error made by the Legendre polynomial series decomposition, which we&#8217;ll call the maximum reconstruction error (<a href="#max_error_reconstruction">Figure 12</a>), which is the error defined by
\begin{center}
max_error_reconstruction = \(\max|\)W_pred-W_pred_reconstruct\(|\)
\end{center}
This will allow us to see if there are any error spikes at certain points.</p>
</div>
<div id="max_error_reconstruction" class="imageblock unresolved">
<div class="content">
<img src="corr/orr_FNO/max_error_reconstruction.pn" alt="max error reconstruction" width="540.0" height="432.0">
</div>
<div class="title">Figure 12. Maximal reconstruction error for each data in test set (at each checkpoint).</div>
</div>
<div class="paragraph">
<p>We can also display solutions in the case of an example (<a href="#example_w">Figure 13</a>). We&#8217;ll take the first data item from the first checkpoint to compare W_pred and W_pred_reconstruct.</p>
</div>
<div id="example_w" class="imageblock unresolved">
<div class="content">
<img src="corr/orr_FNO/example_w.pn" alt="example w" width="540.0" height="432.0">
</div>
<div class="title">Figure 13. Example of result on \(w\) (first data from first checkpoint).</div>
</div>
<div class="paragraph">
<p>It would therefore seem that some regions are more difficult to approach by decomposition than others. We can now look directly at the \(u\) solution, rather than \(w\), and consider it on the circle only. To do this, we multiply the predicted solution by \(\phi\) and apply a mask ( equal to 1 on the domain and 0 outside). We&#8217;re then interested in the same errors, but this time only on the solution in our domain. Consider the mean error on the solution (<a href="#mean_error_solution">Figure 14</a>), defined by
\begin{center}
mean_error_solution = \(||\)(W_pred-W_pred_reconstruct)\(\times\phi||_{0,\Omega}\)
\end{center}</p>
</div>
<div id="mean_error_solution" class="imageblock unresolved">
<div class="content">
<img src="corr/orr_FNO/mean_error_solution.pn" alt="mean error solution" width="540.0" height="432.0">
</div>
<div class="title">Figure 14. Mean solution error for each data in test set (at each checkpoint).</div>
</div>
<div class="paragraph">
<p>Then we also look at the maximum error on the solution (<a href="#max_error_solution">Figure 15</a>), defined by
\begin{center}
max_error_solution = \(\max_\Omega|\)W_pred-W_pred_reconstruct\(|\times\phi\)
\end{center}</p>
</div>
<div id="max_error_solution" class="imageblock unresolved">
<div class="content">
<img src="corr/orr_FNO/max_error_solution.pn" alt="max error solution" width="540.0" height="432.0">
</div>
<div class="title">Figure 15. Max solution error for each data in test set (at each checkpoint).</div>
</div>
<div class="paragraph">
<p>We can then compare the solution with the one reconstructed by the series decomposition of Legendre polynomials on the same example (<a href="#example_y_mask">Figure 16</a>).</p>
</div>
<div id="example_y_mask" class="imageblock unresolved">
<div class="content">
<img src="corr/orr_FNO/example_y_mask.pn" alt="example y mask" width="540.0" height="432.0">
</div>
<div class="title">Figure 16. Example of result on \(y\) (first data from first checkpoint).</div>
</div>
<div class="paragraph">
<p>We can therefore see that it was more interesting to decompose into a series of Legendre polynomials \(w\) and then multiply by \(\phi\), rather than considering \(u\) directly.</p>
</div>
<div class="paragraph">
<p><strong>Correction with the evaluation of the legendre decomposition :</strong></p>
</div>
<div class="paragraph">
<p>We have now recovered the \(\alpha_{p,q}\) coefficients for each data item in the test sample and at each checkpoint. We&#8217;ll try applying the multiplication correction by taking</p>
</div>
<div class="stemblock">
<div class="content">
\[\tilde{\phi}(x,y)=\left(\sum_{p=0}^{P-1}\sum_{q=0}^{Q-1}\alpha_{p,q} P_p(x)P_q(y)\right)\times \phi(x,y)\]
</div>
</div>
<div class="paragraph">
<p>where \(x,y\) are the degrees of freedom associated with \(\mathbb{P}^k\) with \(k\) large enough.</p>
</div>
<div class="paragraph">
<p>For each data item at each checkpoint, we&#8217;ll compare the following errors (<a href="#FNO_corr_Pk">Figure 17</a>): the FNO errors, the errors obtained with the classic multiplication correction (i.e. with \(\tilde{\phi}\) in \(\mathbb{P}_2\) without Legendre polynomial series decomposition) and finally the errors obtained with the decomposition for \(k=3\) and \(k=5\). To do this, we&#8217;ll simply use the calculated coefficients and evaluate the analytical expression of the decomposition in degrees of freedom \(\mathbb{P}_k\) (for \(k=3\) and \(k=5\)). Each of these errors will be calculated using the reference solution (over-refined solution obtained with standard FEM).</p>
</div>
<div id="FNO_corr_Pk" class="imageblock unresolved">
<div class="content">
<img src="corr/orr_FNO/FNO_corr_Pk.pn" alt="FNO corr Pk" width="540.0" height="432.0">
</div>
<div class="title">Figure 17. Correction by multuiplication with stem:[tild</div>
</div>
<div class="paragraph">
<p>At this stage, the error generated by the decomposition into Legendre polynomial series is probably affecting the correction too much. For this reason, we have not pursued this approach.</p>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<script src="../../../_/js/site.js"></script>
<script src="../../../_/js/vendor/highlight.js"></script>
<script>hljs.initHighlighting()</script>
<script src="/_/js/clipboard.min.js"></script>
<script>new ClipboardJS('.btn');</script>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  messageStyle: "none",
  tex2jax: {
    inlineMath: [["\\(", "\\)"]],
    displayMath: [["\\[", "\\]"]],
    ignoreClass: "nostem|nolatexmath"
  },
  asciimath2jax: {
    delimiters: [["\\$", "\\$"]],
    ignoreClass: "nostem|noasciimath"
  },

  TeX: {
      Macros: {
      RR: "{\\mathbb R}",
      NN: "{\\mathbb N}",
      Nso: "{N_{\\mathrm{so}}}",
      Nma: "{N_{\\mathrm{ma}}}",
      Nno: "{N_{\\mathrm{no}}}",
      Ne: "{N_{\\mathrm{e}}}",
      Ilag: ["{\\mathcal{I}^{\\mathrm{lag}}_{#1}}",1],
      calTh: "{\\mathcal{T}_h}",
      Ck: ["{\\mathcal{C}^{#1}}",1],
      Pk: ["{\\mathcal{P}^{#1}}",1],
      Qk: ["{\\mathcal{Q}^{#1}}",1],
      Pch: ["{P^{#1}_{c,h}}",1],
      Pcho: ["{P^{#1}_{c,h,0}}",1],
      Qch: ["{Q^{#1}_{c,h}}",1],
      Ich: ["{\\mathcal{I}^{#1}_{c,h}#2}",2],
      poly: ["{\\mathbb{#1}}",1],
      nf: "{n_f}",
      normal: "{\\mathbf{n}}",
      ngeo: "{n_{\\mathrm{geo}}}",
      geo: "{\\mathrm{geo}}",
      card: ["{\\operatorname{card}(#1)}",1],
      dim: ["{\\operatorname{dim}(#1)}",1],
      opdim: "{\\operatorname{dim}}",
      card: ["{\\operatorname{card}(#1)}",1],
      poly: ["{\\mathbb{#1}}",1],
      R: ["{\\mathbb{R}^{#1}}",1],
      set: ["{\\left\\{#1\\right\\}}",1],
      diam: "{\\operatorname{diam}}",
      jump: ["{[\\![ #1 ]\\!]}",1],
      Next: "{\\mathrm{n}}",
      essinf: "{\\operatorname{ess}\\, \\operatorname{inf}}",
      tr: "{\\operatorname{tr}}",
      Id: "{\\mathcal{I}}",
      disp: ["{\\mathbf{#1}}",1],
      stresst: ["{\\mathbf{\\sigma(#1)}}",1],
      deformt: ["{\\mathbf{\\varepsilon(#1)}}",1],
      domain: "{\\Omega}",
      prect: ["{\\left\\(#1\\right\\)}",1],
      ds: "",
      bold: ["{\\bf #1}",1]
  },
  extensions: ["mhchem.js"] }
});
</script>
<!--<script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/MathJax.js?config=TeX-MML-AM_CHTML"></script>-->
<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML' async></script>
<!--<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.6.0/MathJax.js?config=TeX-MML-AM_HTMLorMML"></script>-->

<!--<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0/katex.min.css" integrity="sha384-TEMocfGvRuD1rIAacqrknm5BQZ7W7uWitoih+jMNFXQIbNl16bO8OZmylH/Vi/Ei" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0/katex.min.js" integrity="sha384-jmxIlussZWB7qCuB+PgKG1uLjjxbVVIayPJwi6cG6Zb4YKq0JIw+OMnkkEC7kYCq" crossorigin="anonymous"></script>-->
  </body>
</html>
